<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Closure</title>
    <style>
      input {
        width: 200px;
      }
      #movies {
        height: 200px;
        width: 206px;
        border: 1px solid black;
        overflow: scroll;
        border-top: none;
      }
    </style>
  </head>
  <body>
    <input
      oninput="debounce(main,1000)"
      type="text"
      id="movie"
      placeholder="Enter movie name"
    />
    <div id="movies"></div>

    <script>
      var timerid;
      var movies_div = document.getElementById("movies");
      async function searchmovies(movie_name) {
        try {
          let res = await fetch(
            `http://www.omdbapi.com/?apikey=563d6682&s=${movie_name}`
          );
          let data = await res.json();
          return data;
        } catch (e) {
          console.log(e);
        }
      }

      function appendMovies(movies) {
        if (movies === undefined) {
          return false;
        }
        console.log(movies);

        movies.forEach(function (movie) {
          let p = document.createElement("p");
          p.innerText = movie.Title;
          movies_div.append(p);
        });
      }

      async function main() {
        let name = document.getElementById("movie").value;
        let res = await searchmovies(name);

        let movies_data = res.Search;
        console.log(movies_data);
        appendMovies(movies_data);
        console.log(res);
      }

      function debounce(func, delay) {
        if (timerid) {
          clearTimeout(timerid);
        }
        timerid = setTimeout(function () {
          func();
        }, delay);
      }
    </script>
  </body>
</html>
